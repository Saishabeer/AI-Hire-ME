{% extends 'base.html' %}

{% block title %}Responses: {{ interview.title }} - AI Interviewer{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="bg-white rounded-lg shadow-lg p-6">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">
            <i class="fas fa-chart-bar text-purple-600 mr-2"></i>Interview Responses
        </h1>
        <p class="text-gray-600">{{ interview.title }}</p>
        <div class="mt-4 flex items-center space-x-6 text-sm text-gray-700">
            <span><i class="fas fa-users mr-2"></i>{{ responses.count }} responses</span>
            <span><i class="fas fa-question-circle mr-2"></i>{{ interview.questions.count }} questions</span>
        </div>
    </div>

    <!-- Responses -->
    {% if responses %}
    <div class="space-y-4">
        {% for response in responses %}
        <div class="bg-white rounded-lg shadow-lg p-6">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 class="text-xl font-bold text-gray-900">{{ response.candidate_name }}</h3>
                    <p class="text-gray-600">{{ response.candidate_email }}</p>
                </div>
                <span class="text-sm text-gray-500">
                    <i class="fas fa-clock mr-1"></i>{{ response.submitted_at|date:"M d, Y H:i" }}
                </span>
            </div>

            <div class="space-y-4">
                {% for answer in response.answers.all %}
                <div class="border-l-4 border-purple-300 pl-4">
                    <p class="font-medium text-gray-900 mb-2">{{ answer.question.question_text }}</p>
                    {% if answer.answer_text %}
                        <p class="text-gray-700">{{ answer.answer_text }}</p>
                    {% elif answer.selected_options.all %}
                        <ul class="list-disc list-inside text-gray-700">
                            {% for option in answer.selected_options.all %}
                            <li>{{ option.option_text }}</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <p class="text-gray-400 italic">No answer provided</p>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="bg-white rounded-lg shadow-lg p-12 text-center">
        <i class="fas fa-inbox text-gray-400 text-6xl mb-4"></i>
        <h3 class="text-xl font-bold text-gray-900 mb-2">No responses yet</h3>
        <p class="text-gray-600 mb-6">Share your interview link with candidates to collect responses</p>
        <code class="bg-gray-100 px-4 py-2 rounded text-sm">
            http://localhost:8000{% url 'interviews:take' interview.pk %}
        </code>
    </div>
    {% endif %}

    <!-- Back Button -->
    <div>
        <a href="{% url 'interviews:edit' interview.pk %}" class="inline-block bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-medium transition">
            <i class="fas fa-arrow-left mr-2"></i>Back to Edit
        </a>
    </div>
</div>
{% endblock %}

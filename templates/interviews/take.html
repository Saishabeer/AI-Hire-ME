{% extends 'base.html' %}

{% block title %}Take Interview — {{ interview.title }}{% endblock %}

{% block content %}
<div class="container page max-w-3xl mx-auto">
  <div class="card">
    <h1 class="text-2xl font-bold mb-2">
      <i class="fas fa-edit mr-2"></i>Take Interview
    </h1>
    <p class="text-gray-700 mb-4">
      {{ interview.title }}
      {% if interview.description %} — {{ interview.description }}{% endif %}
    </p>

    <form method="post" class="space-y-6">
      {% csrf_token %}

      <!-- Candidate info -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-1">Your name</label>
          <input
            type="text"
            name="candidate_name"
            class="w-full border rounded px-3 py-2"
            placeholder="Full name"
            required
          />
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Your email</label>
          <input
            type="email"
            name="candidate_email"
            class="w-full border rounded px-3 py-2"
            placeholder="name@example.com"
            required
          />
        </div>
      </div>

      <!-- Questions -->
      <div class="space-y-6">
        {% for q in interview.questions.all %}
        <div class="border-l-4 border-purple-300 pl-4">
          <div class="flex items-start justify-between">
            <label class="font-semibold text-gray-900 mb-2">
              {{ forloop.counter }}. {{ q.question_text }}
              {% if q.is_required %}<span class="text-red-500 ml-1">*</span>{% endif %}
            </label>
            <span class="text-xs text-gray-500 uppercase tracking-wide">{{ q.get_question_type_display }}</span>
          </div>

          {% if q.question_type == 'text' %}
            <input
              type="text"
              name="question_{{ q.id }}"
              class="w-full border rounded px-3 py-2"
              {% if q.is_required %}required{% endif %}
            />

          {% elif q.question_type == 'textarea' %}
            <textarea
              name="question_{{ q.id }}"
              rows="4"
              class="w-full border rounded px-3 py-2"
              {% if q.is_required %}required{% endif %}
            ></textarea>

          {% elif q.question_type == 'multiple_choice' %}
            <div class="space-y-2">
              {% for opt in q.options.all %}
              <label class="inline-flex items-center space-x-2">
                <input
                  type="radio"
                  name="question_{{ q.id }}"
                  value="{{ opt.id }}"
                  {% if q.is_required and forloop.first %}required{% endif %}
                />
                <span>{{ opt.option_text }}</span>
              </label><br/>
              {% empty %}
                <p class="text-sm text-gray-500">No options configured.</p>
              {% endfor %}
            </div>
          {% else %}
            <input
              type="text"
              name="question_{{ q.id }}"
              class="w-full border rounded px-3 py-2"
              {% if q.is_required %}required{% endif %}
            />
          {% endif %}
        </div>
        {% empty %}
          <div class="text-gray-600">No questions have been added to this interview yet.</div>
        {% endfor %}
      </div>

      <div class="pt-2 flex items-center space-x-3">
        <button type="submit" class="btn btn-success">
          <i class="fas fa-paper-plane mr-2"></i>Submit
        </button>
        <a href="{% url 'interviews:detail' interview.pk %}" class="btn btn-outline">
          <i class="fas fa-arrow-left mr-2"></i>Back
        </a>
      </div>
    </form>

    <p class="text-xs text-gray-500 mt-4">We use your name and email to associate your interview responses.</p>
  </div>
</div>
{% endblock %}